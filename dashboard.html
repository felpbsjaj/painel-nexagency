<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexAgency - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <style>
        body { background-color: #0f172a; font-family: 'Inter', sans-serif; color: white; }
        .sidebar { background-color: #1e293b; border-right: 1px solid #334155; }
        .card-stats { background-color: #1e293b; border: 1px solid #334155; border-radius: 12px; }
        .text-green-custom { color: #4ade80; }
    </style>
</head>
<body class="flex min-h-screen">

    <aside class="w-64 sidebar hidden md:flex flex-col p-6">
        <img src="https://res.cloudinary.com/dsreg6hmo/image/upload/v1767891428/BetBoard/Photos/gpkghm2vdoohymfufbuw.png" class="h-8 mb-10 w-fit">
        <nav class="space-y-4">
            <a href="#" class="flex items-center text-blue-400 font-semibold bg-slate-800 p-3 rounded-lg">
                <span class="mr-3">üìä</span> Overview
            </a>
            <button onclick="mostrarPerfil()" class="flex items-center text-slate-400 hover:text-white p-3 w-full text-left">
                <span class="mr-3">üë§</span> Meu Perfil
            </button>
            <button onclick="logout()" class="flex items-center text-red-400 hover:text-red-300 p-3 w-full text-left mt-10">
                <span class="mr-3">‚Ü™Ô∏è</span> Sair
            </button>
        </nav>
    </aside>

    <main class="flex-1 p-8">
        <header class="flex justify-between items-center mb-10">
            <h2 class="text-2xl font-bold" id="tituloPagina">Overview</h2>
            <div class="flex items-center gap-4">
                <span id="userDisplay" class="text-sm font-medium">...</span>
                <div class="h-10 w-10 bg-slate-700 rounded-full flex items-center justify-center border border-blue-500">N-</div>
            </div>
        </header>

        <div id="secaoOverview" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div class="card-stats p-6">
                <p class="text-slate-400 text-xs font-bold mb-2">REGISTRO</p>
                <h3 id="valRegistro" class="text-3xl font-bold">0</h3>
            </div>
            <div class="card-stats p-6">
                <p class="text-slate-400 text-xs font-bold mb-2">DEP√ìSITO</p>
                <h3 id="valDeposito" class="text-3xl font-bold text-green-custom">R$ 0,00</h3>
            </div>
            <div class="card-stats p-6 border-blue-500">
                <p class="text-blue-400 text-xs font-bold mb-2">CPA</p>
                <h3 id="valCPA" class="text-3xl font-bold text-green-custom">R$ 0,00</h3>
            </div>
        </div>

        <div id="secaoPerfil" class="hidden max-w-2xl mx-auto card-stats p-10 text-center">
            <div class="h-24 w-24 bg-slate-700 rounded-full mx-auto mb-6 flex items-center justify-center text-4xl border-2 border-green-500">N-</div>
            <h2 class="text-2xl font-bold mb-2" id="nomePerfilCompleto">...</h2>
            <p class="text-slate-400 mb-6 uppercase text-sm tracking-widest">Afiliado Verificado</p>
            <button onclick="location.reload()" class="bg-slate-700 px-6 py-2 rounded-lg text-sm hover:bg-slate-600">Voltar para Overview</button>
        </div>
    </main>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyC0oiw7obzsGDBvDr_enJQ1eNHmgPkwNA8",
            authDomain: "nexagency-84caa.firebaseapp.com",
            databaseURL: "https://nexagency-84caa-default-rtdb.firebaseio.com",
            projectId: "nexagency-84caa",
            storageBucket: "nexagency-84caa.firebasestorage.app",
            messagingSenderId: "691404707224",
            appId: "1:691404707224:web:8fed7daf6b4c7c9f8347ed"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const user = localStorage.getItem('usuarioLogado');
        if(!user) window.location.href = 'index.html';

        document.getElementById('userDisplay').innerText = user;
        document.getElementById('nomePerfilCompleto').innerText = "NEX AGENCY - " + user.toUpperCase();

        // Puxa os dados em tempo real
        db.ref('usuarios/' + user).on('value', (snapshot) => {
            const d = snapshot.val();
            if(d) {
                // Aqui voc√™ pode expandir no Admin para salvar estes campos
                document.getElementById('valRegistro').innerText = d.registros || "0";
                document.getElementById('valDeposito').innerText = "R$ " + parseFloat(d.depositos || 0).toLocaleString('pt-BR');
                document.getElementById('valCPA').innerText = "R$ " + parseFloat(d.saldo || 0).toLocaleString('pt-BR');
            }
        });

        function mostrarPerfil() {
            document.getElementById('secaoOverview').classList.add('hidden');
            document.getElementById('secaoPerfil').classList.remove('hidden');
            document.getElementById('tituloPagina').innerText = "Meu Perfil";
        }

        function logout() {
            localStorage.clear();
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>
