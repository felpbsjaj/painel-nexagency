<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexAgency - Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0f111a; color: white; }
        .card-custom { background-color: #161926; border: 1px solid #2d3142; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-6xl mx-auto">
        <div class="flex justify-between items-center mb-8">
            <img src="https://res.cloudinary.com/dsreg6hmo/image/upload/v1767891428/BetBoard/Photos/gpkghm2vdoohymfufbuw.png" class="h-10">
            <div class="text-right">
                <span class="text-blue-500 font-bold">PAINEL ADMIN</span>
                <p class="text-gray-400 text-xs">Gerenciamento de Influenciadores</p>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <div class="card-custom p-6 rounded-xl h-fit">
                <h2 class="text-xl font-semibold mb-6">Novo Influenciador</h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-gray-400 text-sm mb-1">Nome/Usuário</label>
                        <input type="text" id="user" class="w-full bg-[#1c2030] border border-[#2d3142] rounded-lg p-2 text-white outline-none focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-gray-400 text-sm mb-1">Senha Inicial</label>
                        <input type="text" id="pass" class="w-full bg-[#1c2030] border border-[#2d3142] rounded-lg p-2 text-white outline-none focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-gray-400 text-sm mb-1">Saldo/Valor (R$)</label>
                        <input type="number" id="balance" class="w-full bg-[#1c2030] border border-[#2d3142] rounded-lg p-2 text-white outline-none focus:border-blue-500" placeholder="0,00">
                    </div>
                    <button onclick="salvarInfluenciador()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg transition">
                        Criar/Atualizar Acesso
                    </button>
                </div>
            </div>

            <div class="lg:col-span-2 card-custom p-6 rounded-xl">
                <h2 class="text-xl font-semibold mb-6">Usuários Ativos</h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-left">
                        <thead>
                            <tr class="text-gray-500 border-b border-[#2d3142]">
                                <th class="pb-3 px-2">Influenciador</th>
                                <th class="pb-3 px-2">Senha</th>
                                <th class="pb-3 px-2">Saldo Atual</th>
                                <th class="pb-3 px-2 text-center">Ações</th>
                            </tr>
                        </thead>
                        <tbody id="tabelaUsuarios" class="divide-y divide-[#2d3142]">
                            </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>

    <script>
        // CONFIGURAÇÃO DO SEU FIREBASE
        const firebaseConfig = {
            apiKey: "AIzaSyC0oiw7obzsGDBvDr_enJQ1eNHmgPkwNA8",
            authDomain: "nexagency-84caa.firebaseapp.com",
            databaseURL: "https://nexagency-84caa-default-rtdb.firebaseio.com", //
            projectId: "nexagency-84caa",
            storageBucket: "nexagency-84caa.firebasestorage.app",
            messagingSenderId: "691404707224",
            appId: "1:691404707224:web:8fed7daf6b4c7c9f8347ed"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // FUNÇÃO PARA SALVAR
        function salvarInfluenciador() {
            const user = document.getElementById('user').value;
            const pass = document.getElementById('pass').value;
            const balance = document.getElementById('balance').value;

            if (!user || !pass) return alert("Preencha usuário e senha!");

            db.ref('usuarios/' + user).set({
                senha: pass,
                saldo: balance
            }).then(() => {
                alert("Influenciador salvo com sucesso!");
                document.getElementById('user').value = "";
                document.getElementById('pass').value = "";
                document.getElementById('balance').value = "";
            });
        }

        // FUNÇÃO PARA LISTAR EM TEMPO REAL
        db.ref('usuarios').on('value', (snapshot) => {
            const tabela = document.getElementById('tabelaUsuarios');
            tabela.innerHTML = "";
            const dados = snapshot.val();

            if (dados) {
                Object.keys(dados).forEach(key => {
                    const item = dados[key];
                    tabela.innerHTML += `
                        <tr class="hover:bg-[#1c2030] transition">
                            <td class="py-4 px-2 font-medium">${key}</td>
                            <td class="py-4 px-2 text-gray-400 text-sm">${item.senha}</td>
                            <td class="py-4 px-2 text-green-400 font-bold">R$ ${parseFloat(item.saldo || 0).toLocaleString('pt-BR')}</td>
                            <td class="py-4 px-2 text-center">
                                <button onclick="deletar('${key}')" class="text-red-500 hover:text-red-400 text-sm">Excluir</button>
                            </td>
                        </tr>
                    `;
                });
            }
        });

        function deletar(nome) {
            if (confirm("Deseja excluir " + nome + "?")) {
                db.ref('usuarios/' + nome).remove();
            }
        }
    </script>
</body>
</html>
