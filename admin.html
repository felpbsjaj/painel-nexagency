<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>NexAgency - Admin Master</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <style>
        body { background-color: #0f172a; color: white; font-family: 'Inter', sans-serif; }
        .tab-btn { padding: 12px 24px; border-bottom: 2px solid transparent; transition: 0.3s; color: #94a3b8; }
        .tab-btn.active { border-color: #3b82f6; color: #3b82f6; background-color: #1e293b; }
        input, select { background: #1e293b; border: 1px solid #334155; padding: 12px; border-radius: 8px; width: 100%; color: white; margin-bottom: 15px; outline: none; }
        input:focus { border-color: #3b82f6; }
    </style>
</head>
<body class="p-10">
    <script>
        // Prote√ß√£o por senha conforme solicitado anteriormente
        const senhaMestre = "thaimorrowland2026";
        if (prompt("Senha de Admin:") !== senhaMestre) { window.location.href = "index.html"; }
    </script>

    <div class="max-w-4xl mx-auto">
        <div class="flex border-b border-slate-700 mb-10">
            <button onclick="mudarAdminTab('criar')" id="tab-c" class="tab-btn active font-bold">‚ûï Criar Logins</button>
            <button onclick="mudarAdminTab('lancar')" id="tab-l" class="tab-btn font-bold">üìù Lan√ßar Valores</button>
        </div>

        <div id="box-criar" class="bg-slate-800/20 p-8 rounded-2xl border border-slate-700">
            <h2 class="text-xl font-bold mb-6">Cadastrar Novo Influenciador</h2>
            <input type="text" id="new-user" placeholder="Nome de Usu√°rio (Login)">
            <input type="password" id="new-pass" placeholder="Senha de Acesso">
            <button onclick="criarUsuario()" class="w-full bg-blue-600 hover:bg-blue-500 p-4 rounded-xl font-bold transition">CRIAR CONTA</button>
        </div>

        <div id="box-lancar" class="hidden bg-slate-800/20 p-8 rounded-2xl border border-slate-700">
            <h2 class="text-xl font-bold mb-6">Atualizar Painel do Influencer</h2>
            <select id="select-user" onchange="puxarDadosUser()">
                <option value="">Selecione o Influencer...</option>
            </select>
            
            <div class="grid grid-cols-2 gap-4">
                <div><label class="text-xs text-slate-500 font-bold">REGISTROS</label><input type="number" id="edit-reg"></div>
                <div><label class="text-xs text-slate-500 font-bold">FTD</label><input type="number" id="edit-ftd"></div>
                <div><label class="text-xs text-slate-500 font-bold">DEP√ìSITOS (R$)</label><input type="number" id="edit-dep"></div>
                <div><label class="text-xs text-slate-500 font-bold">CPA / SALDO (R$)</label><input type="number" id="edit-cpa"></div>
                <div><label class="text-xs text-slate-500 font-bold">DATA IN√çCIO</label><input type="text" id="edit-data-ini"></div>
                <div><label class="text-xs text-slate-500 font-bold">DATA FIM</label><input type="text" id="edit-data-fim"></div>
            </div>
            <button onclick="salvarAlteracoes()" class="w-full bg-green-600 hover:bg-green-500 p-4 rounded-xl font-bold transition mt-4 uppercase">Lan√ßar Valores Agora</button>
        </div>
    </div>

    <script>
        firebase.initializeApp({ /* Use sua config aqui */ });
        const db = firebase.database();

        function mudarAdminTab(tab) {
            document.getElementById('box-criar').classList.toggle('hidden', tab !== 'criar');
            document.getElementById('box-lancar').classList.toggle('hidden', tab !== 'lancar');
            document.getElementById('tab-c').classList.toggle('active', tab === 'criar');
            document.getElementById('tab-l').classList.toggle('active', tab === 'lancar');
            if(tab === 'lancar') atualizarLista();
        }

        function atualizarLista() {
            db.ref('usuarios').once('value', s => {
                const sel = document.getElementById('select-user');
                sel.innerHTML = '<option value="">Selecione o Influencer...</option>';
                s.forEach(u => sel.innerHTML += `<option value="${u.key}">${u.key}</option>`);
            });
        }

        function criarUsuario() {
            const u = document.getElementById('new-user').value;
            const p = document.getElementById('new-pass').value;
            if(!u || !p) return alert("Preencha tudo!");
            db.ref('usuarios/' + u).set({ senha: p, saldo: 0, ftd: 0, registros: 0, dataInicio: "01/01/2026", dataFim: "31/01/2026" })
            .then(() => alert("Usu√°rio criado!"));
        }

        function salvarAlteracoes() {
            const u = document.getElementById('select-user').value;
            db.ref('usuarios/' + u).update({
                registros: document.getElementById('edit-reg').value,
                ftd: document.getElementById('edit-ftd').value,
                depositos: document.getElementById('edit-dep').value,
                saldo: document.getElementById('edit-cpa').value,
                dataInicio: document.getElementById('edit-data-ini').value,
                dataFim: document.getElementById('edit-data-fim').value
            }).then(() => alert("Valores lan√ßados com sucesso!"));
        }
    </script>
</body>
</html>
